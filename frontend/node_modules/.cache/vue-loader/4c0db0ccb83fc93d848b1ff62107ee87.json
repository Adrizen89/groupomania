{"remainingRequest":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\src\\components\\Accueil\\FormPost.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\src\\components\\Accueil\\FormPost.vue","mtime":1608053158911},{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\vuetify-loader\\lib\\loader.js","mtime":1574476662000},{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\adrie\\Documents\\GitHub\\groupomania\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiDQppbXBvcnQgVG9wSGVhZGVyIGZyb20gIi4vVG9wSGVhZGVyIg0KDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgICBuYW1lOiAiRm9ybVBvc3QiLA0KICAgIGRhdGEoKXsNCiAgICAgICAgcmV0dXJuew0KICAgICAgICAgICAgdmFsaWQ6IHRydWUsDQogICAgICAgICAgICB0aXRsZVJ1bGVzOiBbDQogICAgICAgICAgICAgICAgdiA9PiAhIXYgfHwgJ1RpdHJlIGRlIGxhIHB1YmxpY2F0aW9uJywNCiAgICAgICAgICAgICAgICB2ID0+ICh2ICYmIHYubGVuZ3RoIDw9IDUwKSB8fCAnTGUgdGl0cmUgZG9pdCBmYWlyZSBtb2lucyBkZSA1MCBjYXJhY3TDqHJlcycsDQoNCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICBjb250ZW50UnVsZXM6IFsNCiAgICAgICAgICAgICAgICB2ID0+ICEhdiB8fCAnRWNyaXZleiB2b3RyZSBtZXNzYWdlJywNCiAgICAgICAgICAgIF0sDQogICAgICAgICAgICBkYXRhUG9zdDp7DQogICAgICAgICAgICAgICAgdGl0bGU6ICIiLA0KICAgICAgICAgICAgICAgIGNvbnRlbnQ6IiIsDQogICAgICAgICAgICAgICAgdXNlcklkOiBsb2NhbFN0b3JhZ2UudXNlcklkDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgZGF0YVBvc3RTOiAiIiwNCiAgICAgICAgICAgIG1zZzogZmFsc2UsDQogICAgICAgICAgICBtZXNzYWdlOiAiIiwNCiAgICAgICAgICAgIGltYWdlOiB1bmRlZmluZWQsDQogICAgICAgICAgICBzcmNJbWc6ICIiDQogICAgICAgIH0NCiAgICB9LA0KICAgIG1ldGhvZHM6IHsNCiAgICAgICAgcGFyc2VJbWcoZXZ0KSB7DQogICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsNCiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBlID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLnNyY0ltZyA9IGUudGFyZ2V0LnJlc3VsdDsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChldnQpOw0KICAgICAgICB9LA0KICAgICAgICBpbWFnZUlucHV0KCl7DQogICAgICAgICAgICB0aGlzLmZpbGUgPSB0aGlzLiRyZWZzLmZpbGUuZmlsZXNbMF07DQogICAgICAgICAgICB0aGlzLmltZyA9IFVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5maWxlKTsNCiAgICAgICAgfSwNCiAgICAgICAgDQogICAgICAgIHNlbmRQb3N0KGV2dCl7DQogICAgICAgICAgICBsZXQgYm9keSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgICAgICAgYm9keS5hcHBlbmQoImZpbGUiLCBldnQudGFyZ2V0WzNdLmZpbGVzWzBdKTsNCiAgICAgICAgICAgIGJvZHkuYXBwZW5kKCJ0aXRsZSIsIHRoaXMuZGF0YVBvc3QudGl0bGUpOw0KICAgICAgICAgICAgYm9keS5hcHBlbmQoImNvbnRlbnQiLCB0aGlzLmRhdGFQb3N0LmNvbnRlbnQpOw0KICAgICAgICAgICAgYm9keS5hcHBlbmQoInVzZXJJZCIsIHRoaXMuZGF0YVBvc3QudXNlcklkKTsNCiAgICAgICAgICAgIHRoaXMuZGF0YVBvc3RTID0gSlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhUG9zdCk7DQogICAgICAgICAgICBheGlvcy5wb3N0KCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3RzLyIsIA0KICAgICAgICAgICAgYm9keSwgDQogICAgICAgICAgICB7aGVhZGVyczogDQogICAgICAgICAgICB7J0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywgDQogICAgICAgICAgICBBdXRob3JpemF0aW9uOiAnQmVhcmVyICcgKyBsb2NhbFN0b3JhZ2UudG9rZW59fSkNCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGxldCByZXAgPSBKU09OLnBhcnNlKHJlc3BvbnNlLmRhdGEpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSByZXAubWVzc2FnZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tc2cgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm0gPSBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9BY2N1ZWlsL0ZvcnVtJyk7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmltYWdlICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYm9keS5hcHBlbmQoImZpbGUiLCB0aGlzLmltYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICApDQogICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOyANCiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3I7DQogICAgICAgICAgICAgICAgICAgIHRoaXMubXNnID0gdHJ1ZQ0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICB9LA0KICAgIH0sDQogICAgY29tcG9uZW50czogew0KICAgICAgICAidG9wLWhlYWRlciI6IFRvcEhlYWRlciwgDQogICAgICAgIA0KICAgIH0sDQp9DQo="},{"version":3,"sources":["FormPost.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiDA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"FormPost.vue","sourceRoot":"src/components/Accueil","sourcesContent":["<template>\r\n    <v-app id=\"formPost\">\r\n        <top-header/>\r\n        <h1 class=\"ml-12\">Forum</h1>\r\n        <v-card class=\"ma-3 ml-12\">\r\n            <v-card-title class=\"mb-3\">\r\n                <h2>Nouveau post</h2>\r\n            </v-card-title>\r\n            \r\n            <v-card-text>\r\n                <v-form @submit.prevent=\"sendPost\" id=\"form\" ref=\"form\" class=\"ma-3\" v-model=\"valid\" >\r\n                    <v-text-field v-model=\"dataPost.title\" color=\"black\" :rules=\"titleRules\" :counter=\"50\" label=\"Titre\" autofocus required></v-text-field>\r\n                    <v-textarea v-model=\"dataPost.content\" color=\"black\" :rules=\"contentRules\" label=\"Message\" required></v-textarea>\r\n                    <v-file-input name=\"file\" accept=\"image/png, image/jpg\" hide-input prepend-icon=\"mdi-image-plus\" v-model=\"image\" > </v-file-input>\r\n\r\n                </v-form>\r\n            </v-card-text>\r\n            \r\n\r\n            <v-card-actions>\r\n                \r\n                <v-btn form=\"form\" :disabled=\"!valid\" type=\"submit\" class=\"success\" >Poster</v-btn>\r\n                <v-btn text href=\"/Accueil/Forum\" color=\"black\">Annuler</v-btn>\r\n                \r\n      <div class=\"img-block mx-auto\">\r\n        <img :src=\"srcImg\" alt=\"photo à envoyer\" class=\"img--inside\" />\r\n        <v-btn\r\n            aria-label=\"close\"\r\n            name=\"close\"\r\n          icon\r\n          class=\"ml-auto mr-3 mt-3 btn--close \"\r\n          @click=\"\r\n            srcImg = '';\r\n            image = undefined;\r\n          \"\r\n        >\r\n          <v-icon>\r\n            mdi-close\r\n          </v-icon>\r\n        </v-btn>\r\n      </div>\r\n    \r\n            </v-card-actions>\r\n            \r\n\r\n        </v-card>\r\n    </v-app>\r\n</template>\r\n<script>\r\nimport axios from \"axios\"\r\nimport TopHeader from \"./TopHeader\"\r\n\r\n\r\nexport default {\r\n    name: \"FormPost\",\r\n    data(){\r\n        return{\r\n            valid: true,\r\n            titleRules: [\r\n                v => !!v || 'Titre de la publication',\r\n                v => (v && v.length <= 50) || 'Le titre doit faire moins de 50 caractères',\r\n\r\n            ],\r\n            contentRules: [\r\n                v => !!v || 'Ecrivez votre message',\r\n            ],\r\n            dataPost:{\r\n                title: \"\",\r\n                content:\"\",\r\n                userId: localStorage.userId\r\n            },\r\n            dataPostS: \"\",\r\n            msg: false,\r\n            message: \"\",\r\n            image: undefined,\r\n            srcImg: \"\"\r\n        }\r\n    },\r\n    methods: {\r\n        parseImg(evt) {\r\n            var reader = new FileReader();\r\n            reader.onload = e => {\r\n                this.srcImg = e.target.result;\r\n            };\r\n            reader.readAsDataURL(evt);\r\n        },\r\n        imageInput(){\r\n            this.file = this.$refs.file.files[0];\r\n            this.img = URL.createObjectURL(this.file);\r\n        },\r\n        \r\n        sendPost(evt){\r\n            let body = new FormData();\r\n            body.append(\"file\", evt.target[3].files[0]);\r\n            body.append(\"title\", this.dataPost.title);\r\n            body.append(\"content\", this.dataPost.content);\r\n            body.append(\"userId\", this.dataPost.userId);\r\n            this.dataPostS = JSON.stringify(this.dataPost);\r\n            axios.post(\"http://localhost:3000/api/posts/\", \r\n            body, \r\n            {headers: \r\n            {'Content-Type': 'application/json', \r\n            Authorization: 'Bearer ' + localStorage.token}})\r\n                .then(response => {\r\n                    let rep = JSON.parse(response.data);\r\n                    this.message = rep.message;\r\n                    this.msg = true;\r\n                    this.form = false;\r\n                    this.$router.push('/Accueil/Forum');\r\n                    if (this.image != undefined) {\r\n                        body.append(\"file\", this.image);\r\n                    }\r\n                    },\r\n                    \r\n                )\r\n                .catch(error => {\r\n                    console.log(error); \r\n                    this.message = error;\r\n                    this.msg = true\r\n                });\r\n        },\r\n    },\r\n    components: {\r\n        \"top-header\": TopHeader, \r\n        \r\n    },\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n\r\n    .img {\r\n        &--inside {\r\n            width: 15%;\r\n            height: auto;\r\n        }\r\n    }\r\n</style>"]}]}